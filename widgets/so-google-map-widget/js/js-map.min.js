function loadMap(a){a(".sow-google-map-canvas").each(function(){var o=a(this),e=o.data("address");if(!e){var t=o.data("marker-positions");t&&t.length&&(e=t[0].place)}var n=new google.maps.Geocoder;n.geocode({address:e},function(a,e){if(e==google.maps.GeocoderStatus.OK){var t=Number(o.data("zoom"));t||(t=14);var i="user_map_style",r={zoom:t,scrollwheel:Boolean(o.data("scroll-zoom")),draggable:Boolean(o.data("draggable")),center:a[0].geometry.location,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,i]}},s=new google.maps.Map(o.get(0),r),p={name:o.data("map-name")},l=o.data("map-styles");if(l){var d=new google.maps.StyledMapType(l,p);s.mapTypes.set(i,d),s.setMapTypeId(i)}Boolean(o.data("marker-at-center"))&&new google.maps.Marker({position:a[0].geometry.location,map:s,draggable:Boolean(o.data("markers-draggable")),icon:o.data("marker-icon"),title:""});var g=o.data("marker-positions");g&&g.length&&g.forEach(function(a){var e=function(){n.geocode({address:a.place},function(t,n){n==google.maps.GeocoderStatus.OK?new google.maps.Marker({position:t[0].geometry.location,map:s,draggable:Boolean(o.data("markers-draggable")),icon:o.data("marker-icon"),title:""}):n==google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&setTimeout(e,1e3*Math.random(),a)})};setTimeout(e,1e3*Math.random(),a)});var m=o.data("directions");if(m){m.waypoints&&m.waypoints.length&&m.waypoints.map(function(a){a.stopover=Boolean(a.stopover)});var c=new google.maps.DirectionsRenderer;c.setMap(s);var y=new google.maps.DirectionsService;y.route({origin:m.origin,destination:m.destination,travelMode:m.travelMode.toUpperCase(),avoidHighways:Boolean(m.avoidHighways),avoidTolls:Boolean(m.avoidTolls),waypoints:m.waypoints,optimizeWaypoints:Boolean(m.optimizeWaypoints)},function(a,o){o==google.maps.DirectionsStatus.OK&&c.setDirections(a)})}}else e==google.maps.GeocoderStatus.ZERO_RESULTS&&o.append("<div><p><strong>There were no results for the place you entered. Please try another.</strong></p></div>")})})}function loadApi(a){var o=a(".sow-google-map-canvas").data("api-key"),e="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initialize";o&&(e+="&key="+o);var t=a('<script type="text/javascript" src="'+e+'">');a("body").append(t)}function initialize(){loadMap(window.jQuery)}jQuery(function(a){window.google&&window.google.maps?loadMap(a):loadApi(a)});