!function(e){var i=function(t){"undefined"!=typeof tinyMCEPreInit?(tinyMCEPreInit.mceInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.mceInit.undefined,tinyMCEPreInit.qtInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.qtInit.undefined,QTags.instances.hasOwnProperty("undefined")&&delete QTags.instances.undefined,e(t).find("> .siteorigin-widget-field-type-tinymce > .siteorigin-widget-tinymce-container").each(function(i,t){var n=e(t),r=n.find("textarea"),a=r.attr("id");if(!(a.indexOf("__i__")>-1)){var d=n.data("mceSettings"),o=n.data("widgetIdBase"),s=r.attr("name").replace(/\[\d\]/g,""),c=/[a-zA-Z0-9\-]+(?:\[[a-zA-Z0-9]+\])?\[(.*)\]/.exec(s)[1],f=new RegExp("widget-"+o+"-.*-"+c.replace(/\]\[/g,"-")+"[-d]*");for(var g in tinyMCEPreInit.mceInit)g.match(f)&&(d=e.extend({},tinyMCEPreInit.mceInit[g],d));var m,u=tinymce.get(a);null!=u&&(m=u.getContent(),u.remove());var l=function(e){e.on("change",function(){tinymce.get(a).save(),r.trigger("change")}),e.on("init",function(){m&&e.setContent(m)})};d=e.extend({},d,{selector:"#"+a,setup:l}),tinyMCEPreInit.mceInit[a]=d;var I=n.find("div#wp-"+a+"-wrap");if(I.hasClass("tmce-active"))if(e("#"+a).is(":visible"))tinymce.init(tinyMCEPreInit.mceInit[a]);else var y=setInterval(function(){e("#"+a).is(":visible")&&(tinymce.init(tinyMCEPreInit.mceInit[a]),clearInterval(y))},500);if(!QTags.instances[a]){var p=n.data("qtSettings");p=e.extend({},tinyMCEPreInit.qtInit["siteorigin-widget-input-tinymce-field"],p,{id:a}),tinyMCEPreInit.qtInit[a]=p,n.find(".quicktags-toolbar").remove(),quicktags(tinyMCEPreInit.qtInit[a])}}}),QTags._buttonsInit()):setTimeout(function(){i(t)},500)};e(document).on("sowsetupform",function(t){var n=e(t.target);n.is(".siteorigin-widget-field-repeater-item-form")?n.is(":visible")?i(n):n.on("slideToggleOpenComplete",function(){n.is(":visible")&&(i(n),n.off("slideToggleOpenComplete"))}):i(n)}),e(document).on("sortstop",function(t,n){n.item.is(".siteorigin-widget-field-repeater-item")?n.item.find("> .siteorigin-widget-field-repeater-item-form").each(function(){i(e(this))}):i(n.item.find(".siteorigin-widget-form"))})}(jQuery);